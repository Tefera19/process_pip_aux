[
  {
    "objectID": "auxiliary_files.html",
    "href": "auxiliary_files.html",
    "title": "Auxiliary Files",
    "section": "",
    "text": "Here is the list of auxiliary flies along with variable lists within each of the auxiliary data. In the variable list, the key variable(s) for the underline auxiliary file are represented as bold text. Variables that can be used as interchangeable/ replacement for any of the key variables are represented in square brackets.\n\npfw: wb_region_code, country_code, pcn_region_code, ctryname, year, [surveyid_year], timewp, fieldwork, survey_acronym, link, altname, survey_time, wbint_link, wbext_link, alt_link, pip_meta, surv_title, surv_producer, survey_coverage, [welfare_type], use_imputed, use_microdata, use_bin, use_groupdata, reporting_year, survey_comparability, comp_note, preferable, display_cp, fieldwork_range, [survey_year], ref_year_des, wf_baseprice, wf_baseprice_note, wf_baseprice_des, wf_spatial_des, wf_spatial_var, cpi_replication, cpi_domain, cpi_domain_var, wf_currency_des, ppp_replication, ppp_domain, ppp_domain_var, wf_add_temp_des, wf_add_temp_var, wf_add_spatial_des, wf_add_spatial_var, tosplit, tosplit_var, inpovcal, oth_welfare1_type, oth_welfare1_var, gdp_domain, pce_domain, pop_domain, Note, pfw_id\n\nNote: welfare_type and survey_acronym, and year and surveyid_year can be interchangeably used as key to merge pfw data with other auxiliary files.\n\ncpi: country_code, cpi_year, [survey_year], cpi, ccf, survey_acronym, change_cpi2011, cpi_domain, cpi_domain_value, cpi2017_unadj, cpi2011_unadj, cpi2011, cpi2017, cpi2011_SM22, cpi2017_SM22, cpi2005, cpi_data_level, cpi2011_SM23, cpi2017_SM23, cpi_id\n\nNote: cpi_year and survey_year can be interchangeably used as the pary of key variables.\n\ngdp: country_code, year, gdp, gdp_data_level, gdp_domain\ngdm: survey_id, country_code, surveyid_year, [survey_year], welfare_type, survey_mean_lcu, distribution_type, gd_type, pop_data_level, pcn_source_file, pcn_survey_id\npce: country_code, year, pce, pce_data_level, pce_domain\npop: country_code, year, pop_data_level, pop, pop_domain\nppp: country_code, ppp_year, release_version, adaptation_version, ppp, ppp_default, ppp_default_by_year, ppp_domain, ppp_data_level\n\nNote: ppp auxiliary data may need to be reshaped to merge it with other auxiliary files.\n\nmaddison: country_code, year, mpd_gdp\nweo: country_code, year, weo_gdp\nnpl: country_code, reporting_year, nat_headcount, comparability, footnote\ncountries: country_code, country_name, africa_split, africa_split_code, region, region_code, world, world_code\nregions: region, region_code, grouping_type\nincome_groups: country_code, year_data, incgroup_historical, fcv_historical, ssa_subregion_code\nmetadata: country_code, country_name, reporting_year, [survey_year], surveyid_year, survey_title, survey_conductor, survey_coverage, welfare_type, distribution_type, metadata"
  },
  {
    "objectID": "auxiliary_files.html#list-of-auxiliary-files",
    "href": "auxiliary_files.html#list-of-auxiliary-files",
    "title": "Auxiliary Files",
    "section": "",
    "text": "Here is the list of auxiliary flies along with variable lists within each of the auxiliary data. In the variable list, the key variable(s) for the underline auxiliary file are represented as bold text. Variables that can be used as interchangeable/ replacement for any of the key variables are represented in square brackets.\n\npfw: wb_region_code, country_code, pcn_region_code, ctryname, year, [surveyid_year], timewp, fieldwork, survey_acronym, link, altname, survey_time, wbint_link, wbext_link, alt_link, pip_meta, surv_title, surv_producer, survey_coverage, [welfare_type], use_imputed, use_microdata, use_bin, use_groupdata, reporting_year, survey_comparability, comp_note, preferable, display_cp, fieldwork_range, [survey_year], ref_year_des, wf_baseprice, wf_baseprice_note, wf_baseprice_des, wf_spatial_des, wf_spatial_var, cpi_replication, cpi_domain, cpi_domain_var, wf_currency_des, ppp_replication, ppp_domain, ppp_domain_var, wf_add_temp_des, wf_add_temp_var, wf_add_spatial_des, wf_add_spatial_var, tosplit, tosplit_var, inpovcal, oth_welfare1_type, oth_welfare1_var, gdp_domain, pce_domain, pop_domain, Note, pfw_id\n\nNote: welfare_type and survey_acronym, and year and surveyid_year can be interchangeably used as key to merge pfw data with other auxiliary files.\n\ncpi: country_code, cpi_year, [survey_year], cpi, ccf, survey_acronym, change_cpi2011, cpi_domain, cpi_domain_value, cpi2017_unadj, cpi2011_unadj, cpi2011, cpi2017, cpi2011_SM22, cpi2017_SM22, cpi2005, cpi_data_level, cpi2011_SM23, cpi2017_SM23, cpi_id\n\nNote: cpi_year and survey_year can be interchangeably used as the pary of key variables.\n\ngdp: country_code, year, gdp, gdp_data_level, gdp_domain\ngdm: survey_id, country_code, surveyid_year, [survey_year], welfare_type, survey_mean_lcu, distribution_type, gd_type, pop_data_level, pcn_source_file, pcn_survey_id\npce: country_code, year, pce, pce_data_level, pce_domain\npop: country_code, year, pop_data_level, pop, pop_domain\nppp: country_code, ppp_year, release_version, adaptation_version, ppp, ppp_default, ppp_default_by_year, ppp_domain, ppp_data_level\n\nNote: ppp auxiliary data may need to be reshaped to merge it with other auxiliary files.\n\nmaddison: country_code, year, mpd_gdp\nweo: country_code, year, weo_gdp\nnpl: country_code, reporting_year, nat_headcount, comparability, footnote\ncountries: country_code, country_name, africa_split, africa_split_code, region, region_code, world, world_code\nregions: region, region_code, grouping_type\nincome_groups: country_code, year_data, incgroup_historical, fcv_historical, ssa_subregion_code\nmetadata: country_code, country_name, reporting_year, [survey_year], surveyid_year, survey_title, survey_conductor, survey_coverage, welfare_type, distribution_type, metadata"
  },
  {
    "objectID": "auxiliary_files.html#relationship-between-auxiliary-files",
    "href": "auxiliary_files.html#relationship-between-auxiliary-files",
    "title": "Auxiliary Files",
    "section": "Relationship between auxiliary files",
    "text": "Relationship between auxiliary files\nUnderstanding the relationship among auxiliary files help to merge the files easily. The auxiliary datsets are grouped into three based on unique level of observations. Datasets within each group have one-to-one relationship.\n\nGroup one: maddison, weo\n\nNote: Group one files can be merged with any of the auxiliary files using country_code and year varaibles.\n\nGroup two: gdp, pop, gdm, pce, ppp\n\nNote: ppp requires reshaping to map one-to-one within its group members.\n\nGroup three: metadata, cpi, pfw"
  },
  {
    "objectID": "auxiliary_files.html#merge-auxiliary-files",
    "href": "auxiliary_files.html#merge-auxiliary-files",
    "title": "Auxiliary Files",
    "section": "Merge auxiliary files",
    "text": "Merge auxiliary files\nIn order to merge any two auxiliary data, we may need to change part of key variable names. For example, reporting level variable such as pop_data_level, cpi_data_level, gdp_data_level, pce_data_level and ppp_data_level are same in content and can be renamed as reporting_level and year can be renamed as surveyid_year.\nWe may need to generate a data that contains set of key variables. For example, to merge pfw data with any of the datasets at reporting level (pop, pce, gdp, gdm, ppp) we need to add reporting level variable in pfw data.\nLet’s generate a data that can be used to merge pfw data with datasets at reporting level. This dataset is going to be generated using variables from pfw and cpi datasets.\n\n# pfw ---------------------------------------------------\npfw &lt;- pipload::pip_load_aux(\"pfw\")\n\n✔ Most recent version of data loaded:\n'pfw.qs'\n\n\nℹ no labels available for measure pfw\n\npfw_key_options &lt;- pfw[, .(country_code,\n                            year,\n                            surveyid_year,\n                            survey_acronym,\n                            survey_coverage,\n                            welfare_type,\n                            survey_year,\n                            cpi_domain,\n                            cpi_domain_var)]\n\npfw_key_options |&gt; count(cpi_domain_var)\n\n   cpi_domain_var    n\n1:                2211\n2:          urban   35\n\npfw_key_options &lt;- pfw_key_options[, cpi_domain_value:=\n                                       fifelse(cpi_domain_var == \"urban\",\n                                               0, 1)]\n\n# cpi ---------------------------------------------------\ncpi &lt;- pipload::pip_load_aux(\"cpi\")\n\n✔ Most recent version of data loaded:\n'cpi.qs'\n\ncpi_key &lt;- cpi[, .(country_code,\n                    cpi_year,\n                    survey_year,\n                    survey_acronym,\n                    cpi_domain,\n                    cpi_domain_value,\n                    cpi_data_level)] |&gt;\n  setnames(\"cpi_data_level\", \"reporting_level\")\n\ncpi_key |&gt; count(cpi_domain_value)\n\n   cpi_domain_value    n\n1:                0   36\n2:                1 2247\n\ncpi_key &lt;- cpi_key[, cpi_domain :=\n                       fifelse(cpi_domain == \"National\",\n                                             1, 2)]\n\ncpi_key$cpi_domain  &lt;-  as.numeric(cpi_key$cpi_domain)\n\npfw_cpi_key &lt;- cpi_key[pfw_key_options, on = .(country_code, survey_year,\n                              survey_acronym, cpi_domain, cpi_domain_value)]\n\npfw_cpi_key &lt;- pfw_cpi_key |&gt;\n  group_by(country_code, survey_year,\n           survey_acronym) |&gt;\n  mutate(year_ = mean(year, na.rm = TRUE),\n         surveyid_year_ = mean(surveyid_year, na.rm = TRUE)) |&gt;\n  ungroup() |&gt; \n  mutate(year_ = ifelse(is.na(year_), cpi_year, year_),\n         surveyid_year_ = ifelse(is.na(surveyid_year_), cpi_year, surveyid_year_),\n         year = ifelse(is.na(year), year_, year),\n         surveyid_year = ifelse(is.na(surveyid_year), surveyid_year_, surveyid_year)) |&gt;\n  select(country_code, survey_year, survey_acronym, reporting_level, cpi_domain) |&gt; setDT()\n\n\nany(duplicated(pfw_cpi_key, by = c(\"country_code\", \"survey_year\", \"survey_acronym\", \"cpi_domain\")))\n\n[1] FALSE\n\n\nIn order to merge pfw data with any of the Group two (gdp, pop, gdm, pce, ppp) or Group three (cpi) dataset:\n\nMerge pfw_cpi_key data with pfw dataset\nRename ???_data_level variable in the other dataset to reporting_level. Where ??? could be pop, cpi, gdp, or pce depending on the type of the auxiliary file. For example:\n\n\n# merging pfw, cpi, pop, pce, gdp, gdm and ppp\n\n# first, merge pfw data with pfw_cpi_key datasets\npfw &lt;- pipload::pip_load_aux(\"pfw\")\n\n✔ Most recent version of data loaded:\n'pfw.qs'\n\n\nℹ no labels available for measure pfw\n\npfw &lt;-  pfw_cpi_key[pfw, on= .(country_code, survey_year,\n                                          survey_acronym, cpi_domain)]\n\n# merge pfw with cpi\ncpi &lt;- pipload::pip_load_aux(\"cpi\")\n\n✔ Most recent version of data loaded:\n'cpi.qs'\n\ncpi &lt;- cpi[, -c(\"cpi_domain\")] |&gt; # since it is available in pfw\n  setnames(\"cpi_data_level\", \"reporting_level\")\n\npfw_cpi &lt;- cpi[pfw, on = .(country_code, survey_year, survey_acronym, reporting_level)]\n\n# merge pfw_cpi with pop \npop &lt;- pipload::pip_load_aux(\"pop\")\n\n✔ Most recent version of data loaded:\n'pop.qs'\n\npop &lt;- pop[, -c(\"pop_domain\")] |&gt; # since it is available in pfw\n  setnames(\"pop_data_level\", \"reporting_level\")\n\npfw_cpi_pop &lt;- pop[pfw_cpi, on = .(country_code, year, reporting_level)]\n\n# merge pfw_cpi_pop with pce\npce &lt;- pipload::pip_load_aux(\"pce\")\n\n✔ Most recent version of data loaded:\n'pce.qs'\n\npce &lt;- pce[, -c(\"pce_domain\")] |&gt; # since it is available in pfw\n  setnames(\"pce_data_level\", \"reporting_level\")\n\npfw_cpi_pop_pce &lt;- pce[pfw_cpi_pop, on = .(country_code, year, reporting_level)]\n\n# merge pfw_cpi_pop_pce with gdp\ngdp &lt;- pipload::pip_load_aux(\"gdp\")\n\n✔ Most recent version of data loaded:\n'gdp.qs'\n\ngdp &lt;- gdp[, -c(\"gdp_domain\")] |&gt; # since it is available in pfw\n  setnames(\"gdp_data_level\", \"reporting_level\")\n\npfw_cpi_pop_pce_gdp &lt;- gdp[pfw_cpi_pop_pce, \n                           on = .(country_code, year, reporting_level)]\n\n\n# merge pfw_cpi_pop_pce_gdp with ppp\n# taking the default ppp year\nppp &lt;- pipload::pip_load_aux(\"ppp\")\n\n✔ Most recent version of data loaded:\n'ppp.qs'\n\nppp &lt;- ppp[ppp_default == TRUE, .(country_code, ppp_year, ppp, ppp_data_level)] |&gt; \n  setnames(\"ppp_data_level\", \"reporting_level\")\nany(duplicated(ppp))\n\n[1] FALSE\n\npfw_cpi_pop_pce_gdp_ppp &lt;- ppp[pfw_cpi_pop_pce_gdp, \n                           on = .(country_code, reporting_level)]\n#dcast(ppp, formula = country_code + reporting_level ~ ppp_year, value.var = \"ppp\")\n\nAs demonstrated in the above example, pfw_cpi_key data is a key to merge pfw data with any of the auxiliary data files."
  }
]